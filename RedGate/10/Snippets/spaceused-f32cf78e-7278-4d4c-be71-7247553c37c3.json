{
  "id": "f32cf78e-7278-4d4c-be71-7247553c37c3",
  "prefix": "spaceused",
  "description": "Space Used for daily checks",
  "body": "\r\nuse $CURSOR$;\r\n\r\nselect\r\n    db_name() as DbName,\r\n    df.name   as [FileName],\r\n    df.physical_name,\r\n    fg.name   as [FileGroup],\r\n    SpaceUsedPct          = convert(decimal(10, 2), (fileproperty(df.name, 'SPACEUSED') / (df.[size] * 1.0)) * 100),\r\n    SpaceUsedPctByMaxSize = convert(decimal(10, 2), 100 * (fileproperty(df.name, 'SPACEUSED') / (nullif(df.max_size,-1) * 1.0))),\r\n    -- df.size as size_pgs,\r\n    SizeGb                = convert(decimal(10, 2),(df.[size] * 8192.) / power(1024.,3))\r\nfrom sys.database_files df\r\nleft join sys.filegroups fg on df.data_space_id = fg.data_space_id\r\nwhere df.[type] != 1\r\norder by fg.data_space_id;\r\n\r\nselect file_id,\r\n       type_desc,\r\n       data_space_id,\r\n       name,\r\n       physical_name,\r\n       state_desc,\r\n       convert(decimal(10,2),(size * 8192.)/power(1024.,3)) as size_gb,\r\n       convert(decimal(10,2),(nullif(max_size,-1) * 8192.)/power(1024.,3)) as max_size_gb,\r\n       convert(decimal(10,2),(growth * 8192.)/power(1024.,3)) as growth_gb,\r\n       differential_base_time\r\nfrom sys.database_files;\r\n"
}